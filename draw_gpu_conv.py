import matplotlib.pyplot as plt

x = [1, 2, 3, 4, 5, 6, 7, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60, 64, 68, 72, 76, 80, 84, 88, 92, 96, 100, 104, 108, 112, 116, 120, 124, 128]
# x = [4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60, 64, 68, 72, 76, 80, 84, 88, 92, 96, 100, 104, 108, 112, 116, 120, 124, 128, 132, 136, 140, 144, 148, 152, 156, 160, 164, 168, 172, 176, 180, 184, 188, 192, 196, 200, 204, 208, 212, 216, 220, 224, 228, 232, 236, 240, 244, 248, 252, 256, 260, 264, 268, 272, 276, 280, 284, 288, 292, 296, 300, 304, 308, 312, 316, 320, 324, 328, 332, 336, 340, 344, 348, 352, 356, 360, 364, 368, 372, 376, 380, 384, 388, 392, 396, 400, 404, 408, 412, 416, 420, 424, 428, 432, 436, 440, 444, 448, 452, 456, 460, 464, 468, 472, 476, 480, 484, 488, 492, 496, 500, 504, 508, 512]
# x = [4, 20, 36, 52, 68, 84, 100, 116, 132, 148, 164, 180, 196, 212, 228, 244, 260, 276, 292, 308, 324, 340, 356, 372, 388, 404, 420, 436, 452, 468, 484, 500]

y = [0.005175426124999995, 0.011358409066666679, 0.01157589695555555, 0.011920620533333337, 0.013889685088888892, 0.01656092462222223, 0.016056781266666677, 0.017320731622222262, 0.02205352437777784, 0.04845966800000002, 0.07604928777777764, 0.10738645555555557, 0.13100906355555547, 0.16640562422222224, 0.19067683555555542, 0.22907301333333302, 0.2908067022222224, 0.3291223044444432, 0.3834376355555548, 0.4288654244444442, 0.4817162666666655, 0.5207786177777778, 0.5567818022222236, 0.6584155999999984, 0.7386162199999989, 0.8293495000000002, 0.8711679266666658, 0.9574318466666649, 1.0454014977777781, 1.1479324111111129, 1.224155388888892, 1.2885762666666682, 1.3596770888888854, 1.4616193111111127, 1.5954805555555582, 1.7432889111111214, 1.7942810666666689, 1.8792866444444454]
y = [
    1.13,
    1.14,
    1.14,
    1.15,
    1.14,
    1.13,
    1.15,
    1.16,
    1.18,
    1.17,
    1.19,
    1.21,
    1.21,
    1.25,
    1.21,
    1.21,
    1.22,
    1.22,
    1.22,
    1.23,
    1.24,
    1.25,
    1.26,
    1.27,
    1.28,
    1.29,
    1.30,
    1.32,
    1.32,
    1.33,
    1.33,
    1.34,
    1.39,
    1.50,
    1.50,
    1.52,
    1.52,
    1.53,
]
# y = [0.007189658398611104, 0.008703901090972226, 0.00840395598611109, 0.011044651047619059, 0.012002353515376988, 0.014194022824074075, 0.015240341948412698, 0.016401051524801594, 0.018605128714285716, 0.02002446717757936, 0.02142760184027775, 0.022835956246046795, 0.024242930410218258, 0.025501359042658704, 0.027159852916666692, 0.028510287124503944, 0.029827597609623044, 0.031402155753968326, 0.03332527637152776, 0.0343683776289682, 0.03565146300413362, 0.03712287504150137, 0.03876856790029761, 0.04017731769460985, 0.0418085506706349, 0.043029935677579394, 0.04441668348330027, 0.04609297734573417, 0.04739838758763226, 0.049273967611111025, 0.050647060003141425, 0.05200448205555557, 0.05334065040277774, 0.055473059361111174, 0.05677069013492075, 0.05793897897321428, 0.059854316900793715, 0.06090078306746021, 0.06247903947982801, 0.0637263898611112, 0.06547293928984785, 0.06704588177663533, 0.06866747145386913, 0.06943272880456355, 0.07107243322817465, 0.0728465979097223, 0.07442725624074088, 0.07558563163888894, 0.07748401593750001, 0.07924485572916667, 0.08054248067708339, 0.08200756062499989, 0.08285888458928571, 0.08436785149007936, 0.08632337402777786, 0.08785340078472212, 0.0888601481249999, 0.09074024944047626, 0.0924672879335316, 0.09403975473214271, 0.0954765133333335, 0.09644600017791011, 0.0981884598859125, 0.09937670750595233, 0.1009765045982142, 0.10278649753968236, 0.10395293722222215, 0.10603632416666685, 0.10684680263888893, 0.10850734011904735, 0.11025678777777807, 0.11120826371031754, 0.1130731944444443, 0.115155036805556, 0.11613975937500007, 0.11795967520833346, 0.11936125625000035, 0.12093059583333346, 0.12182937569444427, 0.12329136736111139, 0.125762458333333, 0.12837613750000024, 0.12836857499999982, 0.13772346249999945, 0.13959523302083351, 0.14210252626488107, 0.14351971006944414, 0.14508301335317467, 0.14976997136904793, 0.14879618111772508, 0.14964685507605838, 0.1523832041666666, 0.15608344529761928, 0.1566623467559524, 0.1576393829960318, 0.15989867395833338, 0.16161465520833349, 0.16363139556547632, 0.16530344583333328, 0.16702444708333306, 0.16969291708333353, 0.17111000490079373, 0.17227135980654798, 0.17245935142857163, 0.1735124397619049, 0.17913042985119051, 0.1800050593749996, 0.1815757041666664, 0.18380643333333344, 0.18518048749999985, 0.18703956666666696, 0.18969616250000002, 0.19080728749999945, 0.1923975222222227, 0.19440526944444417, 0.19730085171957634, 0.19935236500000017, 0.20228601666666676, 0.2030314220535713, 0.2047857349305554, 0.20587738861111166, 0.2074083125000002, 0.2107761645287704, 0.21114841944444446, 0.2144007299999995, 0.21490705416666678, 0.21764825381944375, 0.21915655866071407]
# y = [0.0051954925416666615, 0.005949675861111102, 0.00603770268055556, 0.006498019450000009, 0.006804281441269836, 0.007006942288888915, 0.007016671009027759, 0.007062350970833334, 0.007913888579365091, 0.008038612643055554, 0.008123109255555558, 0.008162616291666683, 0.010738857923611107, 0.010902237723214258, 0.011243952412037012, 0.011420991633928573, 0.011580741637896828, 0.011894997018849213, 0.0120206547361111, 0.01212782809027776, 0.012313264226190493, 0.01309666744444445, 0.013766461010912723, 0.01482850311805554, 0.015245156694444439, 0.01544568479166667, 0.01599180106150796, 0.016013046879960365, 0.016183867208333355, 0.01667008814880951, 0.016898900486111125, 0.01710696318055558, 0.01751836691964289, 0.018151642361111105, 0.018330977699404765, 0.019018426388888895, 0.019723195099206406, 0.01965487286507931, 0.020398596382936476, 0.0205905305634921, 0.020782985648809496, 0.021093088270833362, 0.02137264524999999, 0.021462588460317462, 0.022384180644841302, 0.022844432440476167, 0.02301486690277785, 0.023508436902777857, 0.02395433986805555, 0.024046657092261906, 0.024562973819444504, 0.025054357356646812, 0.025493952430555515, 0.025310485416666702, 0.025645746736111176, 0.02588924541666656, 0.026769466263888823, 0.027026046875000043, 0.027470450937499957, 0.028072890351190503, 0.028680476777777783, 0.02862448613988098, 0.02886211771230158, 0.02914655806944445, 0.029562014166666636, 0.029865793687499982, 0.030013272408730245, 0.030426856279761896, 0.03102875791666676, 0.03155001863194452, 0.03187248666666656, 0.03243720215079366, 0.033219613356150826, 0.03309177800992053, 0.03361221091666658, 0.033819003854166675, 0.034026449971726214, 0.03499301737499998, 0.03423482000000006, 0.035411523083333306, 0.03566467868055551, 0.036024390416666614, 0.03646616266666653, 0.036638515736111064, 0.03735241594642848, 0.03741419080555546, 0.038598876399305516, 0.03837064364583329, 0.039147679258928564, 0.038814701249999924, 0.03925060020833329, 0.03992855854166664, 0.04059401720833331, 0.04111909955357134, 0.04108452558333335, 0.04178097566666667, 0.04225561388095224, 0.042818582047619, 0.04295403666666657, 0.04284984458333322, 0.04282559651388902, 0.04366458970833324, 0.04442916055555545, 0.04428140134027771, 0.045208504548611014, 0.04543303475694439, 0.045507554715277745, 0.04571460589583325, 0.04624875765806873, 0.04613072375529099, 0.04606072490112433, 0.04605732277612437, 0.047630314263888904, 0.04800571166666683, 0.04826613250000016, 0.048565021166666805, 0.04942099250000005, 0.04972080666666672, 0.04975536212499986, 0.05033707406646825, 0.05087179101190487, 0.05096041579861107, 0.05226339737599207, 0.05173443229067461, 0.052245303650793544, 0.05256059194444458, 0.05289593628968254, 0.05317905972222234]
# y = [0.004753922208333329, 0.005691218166666653, 0.0056843419999999915, 0.005995577072916677, 0.006005827812748025, 0.0059955467751984, 0.0059996363125000155, 0.006000474329861103, 0.006008100495833344, 0.0060028389652777665, 0.0059978046933531655, 0.006010429829166661, 0.0062294173798610845, 0.006079739269444452, 0.006117111814285712, 0.006559795755555566, 0.006653388538194449, 0.0069642827479166535, 0.007000633104861108, 0.006998433092361119, 0.006998645934126976, 0.0069983902175595365, 0.0070009669689484015, 0.0072014729597222075, 0.009053948117857154, 0.009141861169444453, 0.00914996809375001, 0.009078460106150788, 0.009152708293055572, 0.009384111347916665, 0.009844120744345247, 0.009947958761111085, 0.010014386805555577, 0.00999951660833333, 0.010024774069444452, 0.010000436762500012, 0.010026149726190469, 0.010052465784722193, 0.010059180084325398, 0.010141376073412704, 0.010563718495039672, 0.01066797756547618, 0.010914335770833328, 0.01103817922222221, 0.011074365444444456, 0.011352524583333357, 0.012147288319444454, 0.01273985297420638, 0.013012636764880951, 0.013010120796957684, 0.013023154583333288, 0.013028511932539684, 0.013078476874999993, 0.013057791805555564, 0.013181335972222206, 0.013417574827380896, 0.013433888416666694, 0.013657279687499996, 0.013950219791666642, 0.013947368680555591, 0.013991089083333314, 0.014016416375000023, 0.014034796145833394, 0.014091515520833311, 0.01424960387599208, 0.014326984374999983, 0.014327805208333329, 0.014674351249999976, 0.014772135337301626, 0.015530963333333378, 0.015845233993055537, 0.01649944675694448, 0.016820273979166665, 0.016936633277777814, 0.01694178166666666, 0.01689968041666663, 0.01698948500000003, 0.01698597374999998, 0.017069855416666627, 0.017082584999999987, 0.017093737083333303, 0.017302542916666705, 0.017545867361111044, 0.017474587222222195, 0.017829121250000007, 0.017725724583333307, 0.017736475187499996, 0.01795615957638883, 0.017978052817460302, 0.018133404999999943, 0.018193556749999968, 0.018298670010416664, 0.018605139791666652, 0.019013492916666687, 0.01986001666666672, 0.019985228749999983, 0.020664329166666655, 0.020742155306547622, 0.020491464396825407, 0.020563415243055615, 0.020610847041666665, 0.02079686683333333, 0.02077841954166666, 0.020965689833333336, 0.02097291191666667, 0.02116311812499999, 0.02116918729166666, 0.021324108749999963, 0.02135114291666663, 0.02140212749999997, 0.02133986333333335, 0.021753678333333377, 0.021910606666666717, 0.02196128875000005, 0.022178377916666697, 0.022520715749999958, 0.022453886773809533, 0.022723042916666693, 0.023660379444444466, 0.023868149847222152, 0.024051122291666657, 0.024146812916666736, 0.024105894138888875, 0.02416155832738094, 0.02475004511111113, 0.02443884666666675, 0.02468279749999996, 0.0246924533333334]
# y = [0.004753922208333329, 0.006005827812748025, 0.006008100495833344, 0.0062294173798610845, 0.006653388538194449, 0.006998645934126976, 0.009053948117857154, 0.009152708293055572, 0.010014386805555577, 0.010026149726190469, 0.010563718495039672, 0.011074365444444456, 0.013012636764880951, 0.013078476874999993, 0.013433888416666694, 0.013991089083333314, 0.01424960387599208, 0.014772135337301626, 0.016820273979166665, 0.01698948500000003, 0.017093737083333303, 0.017829121250000007, 0.017978052817460302, 0.018605139791666652, 0.020664329166666655, 0.020610847041666665, 0.02097291191666667, 0.02135114291666663, 0.021910606666666717, 0.022453886773809533, 0.024051122291666657, 0.02475004511111113]

y = [yy - 1.1 for yy in y]
flops = [2 * xx * xx * 9 * 28 * 28 for xx in x]
y = [f / yy / 1000000 for f, yy in zip(flops, y)]

fig, ax = plt.subplots(figsize=(10, 5))

ax.set_xlabel('Channel', fontsize=25)
ax.set_ylabel('FLOPs / latency (G/s)', fontsize=25)

ax.tick_params('y', labelsize=20)
ax.tick_params('x', labelsize=20)

ax.plot(x[:], y[:], marker='v', linestyle='dashed', color='black', label='Stretch')
plt.tight_layout()
plt.savefig('gpu_conv.pdf')
